# 김장 작물 질병 분류 모델 프로젝트
**2024 DSWU 소프트웨어 전공 강의 [딥러닝플랫폼실습] 기말 과제 리포지토리입니다.**

</br>

<details>
<summary>목차</summary>

- [1. 프로젝트 개요](#프로젝트-개요)
- [2. 데이터셋 전처리](#데이터셋-전처리)
- [3. CNN 모델 구축 및 학습](#cnn-모델-구축-및-학습)
    - [CNN](#cnn)
    - [ResNet](#resnet)
- [4. MTL 모델 구축 및 학습](#mtl-모델-구축-및-학습)
    - [기본 모델](#기본-모델)
    - [가중치 비율 적용](#가중치-비율-적용)
- [5. 모델 성능 비교](#모델-성능-비교)
    - [손실함수 적용 비율](#손실함수-적용-비율)
    - [가중치 비율 적용 여부](#가중치-비율-적용-여부)
    - [하이퍼 파라미터 비교](#하이퍼파라미터-비교)
- [6. 프로젝트 주의사항 및 코드 사용 설명](#프로젝트-주의사항-및-코드-사용-설명)
    - [프로젝트 환경](#프로젝트-환경)
    - [주의사항](#주의사항)
    - [코드 사용 설명](#코드-사용-설명)
- [Reference](#reference)

</details>


<br/><br/>

# 프로젝트 개요

<br/><br/>

# 데이터셋 전처리

<br/><br/>

# CNN 모델 구축 및 학습
### CNN

<br/>

### ResNet

<br/><br/>

# MTL 모델 구축 및 학습
### 기본 모델

</br>

### 가중치 비율 적용

</br><br/>

# 모델 성능 비교
### 손실함수 적용 비율
| 손실함수 계산 비율(작물:질병) | 테스트 정확도(작물) | 테스트 정확도(질병) | 정밀도 (Precision) | 재현율 (Recall) |
| -------------------------- | ------------------- | ------------------- | ----------------- | --------------- |
| 0.3:0.7 (B모델)            | 95.97               | 91.58               | 0.95              | 0.89            |
| 0.5:0.5 (A모델)            | 98.53               | 94.02               | 0.93              | 0.89            |

</br>

### 가중치 비율 적용 여부
**1) 0.5:0.5 (작물:질병)**</br>

| 가중치 비율 적용 여부 | 테스트 정확도(작물) | 테스트 정확도(질병) | 정밀도 (Precision) | 재현율 (Recall) |
| ------------------- | ------------------- | ------------------- | ----------------- | --------------- |
| O                   | 98.53               | 92.55               | 0.91              | 0.90            |
| X (A모델)            | 98.53               | 94.02               | 0.93              | 0.89            |

</br>

**2) 0.3:0.7 (작물:질병)**</br>

| 가중치 비율 적용 여부 | 테스트 정확도(작물) | 테스트 정확도(질병) | 정밀도 (Precision) | 재현율 (Recall) |
| ------------------- | ------------------- | ------------------- | ----------------- | --------------- |
| O                   | 97.56               | 87.06               | 0.92              | 0.91            |
| X (B모델)            | 95.97               | 91.58               | 0.95              | 0.89            |

</br>

### 하이퍼파라미터 비교
- 손실함수 적용 비율은 동일한 비율(0.5)
- 가중치 비율 적용
    - A 모델만 가중치 적용X
    - 나머지는 가중치 적용O

| 배치 사이즈 | 에폭 | 테스트 정확도(작물) | 테스트 정확도(질병) | 정밀도 (Precision) | 재현율 (Recall) |
| ----------- | ---- | ------------------- | ------------------- | ----------------- | --------------- |
| 32 (A모델)  | 10   | 98.53               | **94.02**            | 0.93              | 0.89            |
| 32          | 20   | 98.90               | 93.53               | 0.62              | 0.63            |
| 64 (C모델)  | 10   | 99.15               | 92.92               | 0.91              | **0.92**        |
| 64          | 20   | 97.92               | 91.94               | 0.91              | 0.90            |


<br/><br/>

# 프로젝트 주의사항 및 코드 사용 설명
### 프로젝트 환경
- Python 버전: 3.9.20
- CUDA 버전: 11.8
- 사용 도구: Visual Studio Code, Jupyter Notebook
- 사용 폰트(혼동행렬): 맑은고딕

</br>

### 주의사항
- 학습을 진행하기 위해서는 **반드시 GPU를 사용해야 합니다.**
    - 특히 MTL 모델 학습의 경우 GPU를 사용하지 않을 시 학습이 진행되지 않습니다.
    - check_cuda 폴더 내의 cuda 사용 여부 코드를 사용하여 GPU를 사용중인지 확인해주세요.
- **과제를 진행하는 과정에서 주피터 노트북 파일에서는 GPU를 사용할 수 없어 파이썬 파일로 학습을 진행하였습니다.**
    - **과정 가시화를 위해 주피터 노트북 파일을 첨부하나 실제 학습 진행은 파이썬 파일로 진행하여 실행 결과가 저장되지 않았음을 유의해주세요.**

</br>

### 코드 사용 설명
- 

<br/><br/>

## Reference
- [MTL 모델 레퍼런스](https://gaussian37.github.io/dl-concept-mtl/#%EB%A9%80%ED%8B%B0-%ED%83%9C%EC%8A%A4%ED%81%AC-%EB%9F%AC%EB%8B%9D-%EA%B5%AC%ED%98%84-%EB%B0%8F-%EC%8B%A4%EC%8A%B5-1)
    - [모델 코드](https://colab.research.google.com/drive/1_hEKSoi9_UMZ5el-7PbjwwRedLYgS1w3?usp=sharing)
